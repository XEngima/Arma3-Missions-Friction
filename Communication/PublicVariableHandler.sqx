/*
 * Name:	PublicVariableHandler
 * Date:	2017-11-30
 * Version: 1.0
 * Author:  Engima
 *
 * Description:
 * Encapsulates all global variable handling and keeps its global properties persistent and at sync.
 * over the network.
 *
 * Remarks:
 * This is the *only* only file where the global public network variables are actually written.
 */

using Mission.Common;

namespace Mission.Communication
{
	public class PublicVariableHandler
	{
		// [Here is an example for how to handle one public variable. Each public variable should have three methods:
		// one the broadcasts the variable, one to check if the value exists (if it is broadcast at lease once),
		// and one that gets it.]
		
		#region MissionInfo
		
		// Sets and broadcasts mission info across the network.
		// _missionInfo (MissionInfo): The mission info object to be broadcasted.
		public static method BroadcastMissionInfo("_missionInfo" as MissionInfo)
		{
			PUBVAR_MissionInfo = _missionInfo;
			publicVariable "PUBVAR_MissionInfo";
		};
		
		// Gets whether the variable for mission has started has been public variabled at least once, so it actually has a value.
		public static method Boolean HasValueMissionInfo {
			!isNil "PUBVAR_MissionInfo"
		};
		
		// Gets the mission info object from the public network synchronized variable.
		// Before using this method, always call the corresponding HasValue method, since it might be nil if not yet broadcast.
		public static method MissionInfo GetMissionInfo { 
			PUBVAR_MissionInfo
		};
		
		// Sets and broadcasts campaign phase across the network.
		// _campaignPhase (CampaignPhase): The campaign phase object to be broadcasted.
		public static method BroadcastCampaignPhase("_campaignPhase" as CampaignPhase)
		{
			PUBVAR_CampaignPhase = _campaignPhase;
			publicVariable "PUBVAR_CampaignPhase";
		};
		
		// Gets whether the variable for campaign phase has started has been public variabled at least once, so it actually has a value.
		public static method Boolean HasValueCampaignPhase() {
			return !isNil "PUBVAR_CampaignPhase";
		};
		
		// Gets the campaign phase object from the public network synchronized variable.
		// Before using this method, always call the corresponding HasValue method, since it might be nil if not yet broadcast.
		public static method CampaignPhase GetCampaignPhase("_defaultCampaignPhase" as CampaignPhase)
		{
			if (call _self.HasValueCampaignPhase) then {
				return PUBVAR_CampaignPhase;
			};

			return _defaultCampaignPhase;
		};
		
		// Sets and broadcasts mission markers info across the network.
		// _campaignPhase (CampaignPhase): The mission markers info object to be broadcasted.
		public static method BroadcastMissionMarkersInfo("_missionMarkersInfo" as MissionMarkersInfo)
		{
			PUBVAR_MissionMarkersInfo = _missionMarkersInfo;
			publicVariable "PUBVAR_MissionMarkersInfo";
		};
		
		// Gets whether the variable for mission markers info has started has been public variabled at least once, so it actually has a value.
		public static method Boolean HasValueMissionMarkersInfo() {
			return !isNil "PUBVAR_MissionMarkersInfo";
		};
		
		// Gets the mission markers info object from the public network synchronized variable.
		// Before using this method, always call the corresponding HasValue method, since it might be nil if not yet broadcast.
		public static method MissionMarkersInfo GetMissionMarkersInfo()
		{
			if (call _self.HasValueMissionMarkersInfo) then {
				return PUBVAR_MissionMarkersInfo;
			};

			return classNull;
		};
		
		#endregion
	};
};
