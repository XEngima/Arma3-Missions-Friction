/*
 * Name:	ServerEventReciever
 * Date:	2019-01-31
 * Version: 1.0
 * Author:  Engima
 *
 * Description:
 * Static class that handles all custom events sent from other machines.
 */

using Mission.Communication;
using Mission.Common.Statics;

namespace Mission.Server.Statics
{
	public class ServerEventReciever
	{
		// Called when a player is performing an insertion.
		// _side (Side): The side to insert.
		// _position (Array): The position where to insert all players on the side.
		public static method OnPlayerPerformingInsertion("_side" as Side, "_position" as Array)
		{
			[_side, _position] call ServerObjects.CampaignEngine.InsertGroup;
			
			// If the side contains no players, move them as server
			private _switchableUnits = call ServerObjects.MissionUnitsHandler.GetSwitchableUnits;
			
			if ({ side group _x == _side && isPlayer _x } count _switchableUnits == 0) then {
				{
					if (side group _x == _side) then {
						_x setPos _position;
					};
				} foreach _switchableUnits as Object;
			};
			
			{
				if (side group _x == _side) then
				{
					["ClientEventReciever.OnInsertGroup", [group _x, _position]] call Remote.Invoke;
					return;
				};
			} foreach _switchableUnits;
			
			{
				if (side group _x == _side) then
				{
					["ClientEventReciever.OnInsertGroup", [group _x, _position]] call Remote.Invoke;
					return;
				};
			} foreach _switchableUnits;
		};
		
		public static method OnPlayerKilled("_player" as Object, "_killer" as Object)
		{		
		};
		
		public static method OnAction("_serverActionId" as Scalar, "_target" as Object, "_caller" as Object)
		{
			[_serverActionId, _target, _caller] call ServerObjects.CampaignEngine.OnAction;
		};
	};
};
